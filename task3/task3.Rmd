---
title: "Rulete ir Moneta"
author: "Paulius Kostickis"
date: "Monday, March 07, 2016"
output: html_document
---

###Uzduotis Rulete:
Nagrinëkime standartinæ kazino ruletæ. Kokia tikimybë po 1000 vienodø statymø ant vienos pasirinktos spalvos, bus 
teigiamas balansas? Raskite apytikslæ x reiksmæ, kuriai galioja nelygybë 
P( balansas < x ) = 0.25.

Taisyklës: yra 37 skaièiai ruletës rate, po 18 juodø ir raudonø skaièiø ir vienas þalias skaièius. Galima statyti ant 
pasirinktos juodos arba raudonos spalvos ir jei pasirinkta spalva iðkrenta, gauname dvigubà pastatytà sumà atgal. Jei 
neiðkrenta pasirinkta spalva, pralaimime statymà. Jei iskrenta vienintelis þalias skaièius, prarandame pusës statytos 
sumos.

Taigi sukuriame vienos dienos loðimo sesijos simuliacijos funkcijà, kurioje iðsukama rulete 1000 kartø:
```{r}
gamble <- function(){
  x =sample(c(-0.5,-1,1),1000,prob = c(1/37,18/37,18/37),replace=T)
  x=sum(x)
}
```

Naudojant monte carlo metodà bandysime atsakyti á uþduotus klausimus, sudarome 10^5 loðimø sesijø: 
```{r}
y <- replicate(10^5,gamble())
```

Tikimybë, kad balansas > 0
```{r}
p=mean(y>0)
p

```
Kad galiotu P ( balansas < x ) = 0.25, x turi bûti:
```{r}
x=quantile(y, 0.25)
unname(x)
```



###Uzduotis moneta:
Tarkime metama moneta. Jeigu iðkrenta herbas, tai laimite 12 EUR. Jeigu skaièius, tai praloðiama 10 EUR. Bus zaidziama n kartu ir gauti rezultatai sumuojami. Kokia tikimybë jums tureti teigiamà balansà po n kartø? Kokis iðlosiø pasikliautiniai 95% intervalai. Iðtirkite tikimybes su skirtingais n, pvz. n=1,2,5,10,20,100. Kaip atrodo balanso tankis? Kai n=100.

Funkcija n iðmetimo simuliacija:
```{r}
flip <- function(n){
    x=sample(c(-10,12),n,replace=T)
    x=sum(x)
}
```

Tirsime loðimo sesijà, kai metama n kartø (t.y. 1,2,5,10,20,100). Naudosime monte carlo metodà ir simuliuosime 10^4 losimø sesijø su n metimø vienoje sesijoje ir viskà iðsaugau matricoje y.

```{r}
n=c(1,2,5,10,20,100)
u = numeric(0)
for(i in 1:6){
  a<- replicate(10^4,flip(n[i]))
  u = c(u,a)
}
y=matrix(u, byrow = F, ncol = 6)
head(y)
```

Kaip matome, pirmas stulpelis sesijø realizacijos, kai n=1; antras stulpelis, kai n=2 (du kartus mesta moneta sesijoje) ir pan.  


Dabar galime gauti gan tikslø tikimybiø vektoriø, kurio kiekviena pozicija atitinkamai atsako á klausimà kokia tikimybë, kad po sesijos bus teigiamas balansas, kai n=1,2,5,10,20,100.

```{r}
  p=numeric(0)
  for(i in 1:6){
  p[i]<-mean(y[,i]>0)
  print(paste("kai n=",i," tikimybë teigiamo balanso",p[i],collapse= " "))
 
}
```


O atitinkamu n=1,2,5,10,20,100 metimø per sesijà laimejimø 95% pasikliautinieji intervalai yra:

```{r}
g=numeric(0)
for(i in 1:6){
  x=c(quantile(y[,i], 0.025),quantile(y[,i], 0.975))
  g=c("kai n =", i, "  95% intervalas:" ,"[",unname(x[1]),",",unname(x[2]),"]")
  print(paste(g,collapse=" "))
}

```

Tankio grafikas, kai n= 100 (N=10000 reiðkia sesijø skaièiø)
```{r}
plot(density(y[,6]),main="tankis, kai n=100", lwd = 2)
```